classdef Fig_2_1D
    methods (Static)         
        %% > Wrap-up Fig_2 (1D).
        function [] = WrapUp_Fig_2_1D(Plot_2,Exp_2,Fig,msh,pde)
            if Plot_2               
                %  > Figure 1.
                figure(Fig(1)); set(gcf,'Units','pixels','Position',[250,100,1050,650]);
                Fig_2_1D.Plot_1(msh,pde);
                %  > Figure 2.
                %  > Export as .pdf.
                if Exp_2
                    Fig_Tools_1D.Export_PDF('ET_4_1 (3)','../[Figures]/[1D]/Fig_2');
                end
                %  figure(Fig(2)); set(gcf,'Units','pixels','Position',[250,100,1050,650]);
                %  Fig_2_1D.Plot_2(msh,pde);
                %  > Export as .pdf.
                %  if Exp_2
                %     Fig_Tools_1D.Export_PDF('ET_4_2 (3)','../[Figures]/[1D]/Fig_2');
                %  end
            end
        end
        
        %% > 1. -----------------------------------------------------------
        % >> 1.1. ---------------------------------------------------------
        function [] = Plot_1(msh,pde)
            %  > Auxiliary variables.
            Xvi   = msh.f.Xv(1);
            Xvf   = msh.f.Xv(end);
            C1    = linspecer(9 ,'qualitative');
            C2    = linspecer(20,'sequential');
            L     = Fig_2_1D.Set_Labels_1();
            [m,n] = size(msh.s.xf);
            for i = 1:m
                for j = 1:n
                    p(j,i) = length(msh.s.xf{i,j});
                end
            end
            %  > 1.1.1. ---------------------------------------------------
            %subplot(2,1,1);
            Fig_2_1D.SubPlot_1(msh,pde,Xvi,Xvf,C1,L);
            %  > 1.1.2. ---------------------------------------------------
            %subplot(2,1,2);
            %Fig_2_1D.SubPlot_3(msh,C2,p,m,n);           
        end
        %  > 1.1.1. -------------------------------------------------------
        function [] = SubPlot_1(msh,pde,Xvi,Xvf,C1,L)
            %  > Plot...
            m = size(pde.e.t.f,2)+1;
            hold on;
            for j = 2:m
                if j == 2%m
                    P{1}   = plot(msh.f.Xv,pde.e.t.f(:,j),'-^','Color',C1(5,:),'LineWidth',3.0,'MarkerFaceColor',C1(5,:),'MarkerSize',5.0);
                    P{2} = line([Xvi,Xvf],[pde.e.t.n.f(1,j),pde.e.t.n.f(1,j)],'Color',C1(5,:),'Linewidth',2.5,'Linestyle','-');
                else
                    %P{j+m} = line([Xvi,Xvf],[pde.e.t.n.t(1,1),pde.e.t.n.t(1,1)],'Color',C1(j,:),'Linewidth',1.0,'Linestyle','--');
                end
            end
            P{3} = plot(msh.c.Xc,abs(pde.e.t.c(:,1)),'-^','Color',C1(6,:),'LineWidth',3.0,'MarkerFaceColor',C1(6,:),'MarkerSize',5.0);
            P{4} = line([Xvi,Xvf],[pde.e.t.n.c(1,1),pde.e.t.n.c(1,1)],'Color',C1(6,:),'Linewidth',2.5,'Linestyle','-');

            A_1 = [4.01652156498215e-10;1.38827546139259e-10;3.43119636046156e-10;8.30014736357100e-10;1.96500789679927e-09;4.55246364449015e-09;1.03203627060523e-08;2.28912322008537e-08;4.96735311366549e-08;1.05442209717002e-07;2.18919796189335e-07;4.44507439949090e-07;8.82537369742125e-07;1.71307836922536e-06;3.25037736224028e-06;6.02720983878136e-06;1.09201369446172e-05;1.93268163009128e-05;3.34033462907005e-05;5.63607838315544e-05;9.28027793003798e-05;0.000149058417297737;0.000233425159478402;0.000356188935193853;0.000529239890424076;0.000765067843049208;0.00107492269571047;0.00146598779432658;0.00193756251928262;0.00247649666335392;0.00305245208952498;0.00361394067164667;0.00408641554276024;0.00437385556396408;0.00436514943371025;0.00394605077348009;0.00301650674566423;0.00151184475813615;0.000575142128292683;4.05418277402703e-05;1.33226680727461e-05;2.16375786603606e-05;6.06625585461984e-05;9.86603113766194e-05;0.000129836603981914;0.000148678460475615;0.000151025185815890;0.000134995399999838;0.000101544933207354;5.44969676916640e-05;0;5.44969676916640e-05;0.000101544933207354;0.000134995399999838;0.000151025185799014;0.000148678460481833;0.000129836603987243;9.86603113695139e-05;6.06625585550802e-05;2.16375786621370e-05;1.33226680727461e-05;4.05418277402703e-05;0.000575142128292683;0.00151184475813615;0.00301650674566423;0.00394605077348009;0.00436514943371646;0.00437385556396297;0.00408641554276090;0.00361394067164533;0.00305245208952432;0.00247649666335226;0.00193756251928257;0.00146598779432658;0.00107492269571047;0.000765067843049208;0.000529239890424076;0.000356188935193742;0.000233425159478402;0.000149058417297761;9.28027793003529e-05;5.63607838315666e-05;3.34033462907049e-05;1.93268163009234e-05;1.09201369446172e-05;6.02720983878044e-06;3.25037736224028e-06;1.71307836922536e-06;8.82537369742125e-07;4.44507439949040e-07;2.18919796189335e-07;1.05442209717002e-07;4.96735311366734e-08;2.28912322008507e-08;1.03203627060487e-08;4.55246364449102e-09;1.96500789679935e-09;8.30014736357081e-10;3.43119636046146e-10;1.38827546139256e-10;4.01652156498213e-10];
            A_2 = [0,0.000766539745982781];
            A_3 = [2.62824610358948e-10;2.04292089906897e-10;4.86895100310953e-10;1.13499316044215e-09;2.58745574769089e-09;5.76789906156236e-09;1.25708694948018e-08;2.67822989358065e-08;5.57686785803290e-08;1.13477586472312e-07;2.25587643759774e-07;4.38029929793054e-07;8.30540999483273e-07;1.53729899301474e-06;2.77683247654193e-06;4.89292710583611e-06;8.40667935629851e-06;1.40765299897817e-05;2.29574375408509e-05;3.64419954688366e-05;5.62556379973189e-05;8.43667421806683e-05;0.000122763775715420;0.000173050955230177;0.000235827952625181;0.000309854852661481;0.000391065098616361;0.000471574724954946;0.000538934144073022;0.000575955426168617;0.000561488582123682;0.000472474871113737;0.000287440021204288;8.70613024794853e-06;0.000419098660247808;0.000929544027811979;0.00150466198752419;0.00208698688642872;0.000615683956045166;2.72191596467630e-05;3.49602467831778e-05;3.90249798838949e-05;3.79977527979192e-05;3.11762926089865e-05;1.88418564998072e-05;2.34672535059932e-06;1.60297858033953e-05;3.34504668222380e-05;4.70479655365619e-05;5.44969677014340e-05;5.44969676981033e-05;4.70479655167999e-05;3.34504668015878e-05;1.60297857814129e-05;2.34672527099633e-06;1.88418564843751e-05;3.11762926822057e-05;3.79977528533193e-05;3.90249797955766e-05;3.49602467684118e-05;2.72191596665250e-05;0.000615683956016966;0.00208698688642939;0.00150466198750443;0.000929544027831075;0.000419098660218054;8.70613025627520e-06;0.000287440021203789;0.000472474871130779;0.000561488582118686;0.000575955426169228;0.000538934144069775;0.000471574724956791;0.000391065098614710;0.000309854852661003;0.000235827952625320;0.000173050955230219;0.000122763775715216;8.43667421805815e-05;5.62556379974290e-05;3.64419954688331e-05;2.29574375409090e-05;1.40765299897728e-05;8.40667935631727e-06;4.89292710583405e-06;2.77683247653694e-06;1.53729899301417e-06;8.30540999483165e-07;4.38029929792861e-07;2.25587643759881e-07;1.13477586472301e-07;5.57686785803345e-08;2.67822989358105e-08;1.25708694948062e-08;5.76789906155844e-09;2.58745574769216e-09;1.13499316044250e-09;4.86895100310751e-10;2.04292089906848e-10;2.62824610358983e-10];
            A_4 = [0.000205622590712495;0.000205622590712495;0.00208698688642939];
                      
            P{5} = plot(msh.f.Xv,A_1,':o','Color',C1(2,:),'LineWidth',3.0,'MarkerFaceColor',C1(2,:),'MarkerSize',5.0);
            P{6} = line([Xvi,Xvf],[A_2(1,2),A_2(1,2)],'Color',C1(2,:),'Linewidth',2.5,'Linestyle','-.');
            P{7} = plot(msh.c.Xc,abs(A_3),':o','Color',C1(3,:),'LineWidth',3.0,'MarkerFaceColor',C1(3,:),'MarkerSize',5.0);
            P{8} = line([Xvi,Xvf],[A_4(1,1),A_4(1,1)],'Color',C1(3,:),'Linewidth',2.5,'Linestyle','-.');
                        
            Pk  {1} = plot(NaN,NaN,':o','Color','k','MarkerFaceColor','w','MarkerSize',3.5);
            Pk  {2} = plot(NaN,NaN,'-^','Color','k','MarkerFaceColor','w','MarkerSize',3.5);
            Lk{1,1} = '$_{\mathcal{D}_{1}}$';
            Lk{1,2} = '$_{\mathcal{D}_{1}+\mathcal{D}_{2}}$';
          
          
            legendflex([Pk{:}],Lk,'buffer',[-0.010,-0.025],'bufferunit', 'normalized',...
                'Interpreter','latex','Location','Southeast','FontSize',25,'NumColumns',2);

            %legend([P{:}],[L{2},L{4},L{6},L{7},L{8}],...
            %    'Interpreter','latex','Location','Southeast','FontSize',25,'NumColumns',2);
            %  > Axis.
            Fig_Tools_1D.ChangeLook_1D(true,true,true,msh.f.Xv,10,"$x$",L{8},30,30);
            ylim([10^-14,10^0]);
            set(gca,'YScale','log');
        end
        %  > 1.1.2. -------------------------------------------------------
        function [] = SubPlot_3(msh,C2,p,m,n)
            %  > Auxiliary variables.
            N = 9;
            Y = [2/N,1/N,1];  
            M = ["-o","o","-s","s"];
            %  > Plot...
            hold on;
            for i = 1:m
                plot(msh.f.Xv,repelem(Y(i),msh.f.NF),'-','Color','k','MarkerFaceColor','k','MarkerSize',10.0,'Linewidth',0.1);
                pm{1} = unique(p(:,i));
            end
            hold on;
            for i = 1:m+1
                if i ~= m+1
                    for j = 1:n
                        plot(msh.f.Xv(j),Y(i),M(2*i-1),'Color',C2(p(j,i),:),'MarkerFaceColor',C2(p(j,i),:),'MarkerSize',4.5);
                    end
                else
                    plot(0.5,(N-1)/N,'o','Color','w','MarkerFaceColor','w','MarkerSize',4.5);
                end 
            end
            %  > Legend.
            for i = 1:m
                pm{i} = unique(p(:,i));
            end
            i = 1;
            for j = 1:length(pm{i})+1
                if j == 1
                    Pj  {j} = plot(NaN,NaN,M(i),'Color','k','MarkerFaceColor','w','MarkerSize',3.5);
                    Lj{1,j} = '${\phi}_{f}\phantom{:}$';
                else
                    Pj  {j} = plot(NaN,NaN,M(i+1),'Color',C2(pm{i}(j-1),:),'MarkerFaceColor',C2(pm{i}(j-1),:),'MarkerSize',3.5);
                    Lj{1,j} = join(['$',num2str(pm{i}(j-1)),'\phantom{:}$']);
                end
            end
            i = 2;
            for k = 1:length(pm{i})+1
                if k == 1
                    Pk  {k} = plot(NaN,NaN,M(i+1),'Color','k','MarkerFaceColor','w','MarkerSize',3.5);
                    Lk{1,k} = '${\nabla\phi}_{f}\phantom{:}$';
                else
                    Pk  {k} = plot(NaN,NaN,M(i+2),'Color',C2(pm{i}(k-1),:),'MarkerFaceColor',C2(pm{i}(k-1),:),'MarkerSize',3.5);
                    Lk{1,k} = join(['$',num2str(pm{i}(k-1)),'\phantom{:}$']);
                end
            end
            legendflex([Pj{:}],Lj,'buffer',[-0.090,-0.025],'bufferunit', 'normalized',...
                'Interpreter','latex','Location','Northeast','FontSize',10,'NumColumns',2);
            legendflex([Pk{:}],Lk,'buffer',[-0.010,-0.025],'bufferunit', 'normalized',...
                'Interpreter','latex','Location','Northeast','FontSize',10,'NumColumns',2);
            %  > Axis.
            Fig_Tools_1D.ChangeLook_1D(false,true,false,msh.f.Xv,10,"$x$","$y$",20,12);
            ax = gca; box on; ylim([0,1]); set(gca,'YTickLabel',[]); yticks([0,1]);
        end
        % >> 1.2. ---------------------------------------------------------
        function [L] = Set_Labels_1()
            L{1} = "$|\tau_{f}^{\phantom{\nabla}\phi}|$";
            L{2} = "$|\tau_{f}^{\nabla\phi}|$";
            L{3} = "$|\!|\tau_{f}^{\phantom{\nabla}\phi}|\!|_{1}$";
            L{4} = "$|\!|\tau_{f}^{\nabla\phi}|\!|_{1}$";
            L{5} = "$|\!|\bar\tau_{f}^{\phantom{\nabla\phi}}|\!|_{1}$";
            L{6} = "$|\tau_{c}|$";
            L{7} = "$|\!|\tau_{c}|\!|_{1}$";
            L{8} = "$\textrm{Error magnitude}, |\tau^{\phi}|$";
        end
        
        %% > 2. -----------------------------------------------------------
        % >> 2.1. ---------------------------------------------------------
        function [] = Plot_2(msh,pde)
            %  > Auxiliary variables.
            Xvi   = msh.f.Xv(1);
            Xvf   = msh.f.Xv(end);
            C1    = linspecer(9 ,'qualitative');
            C2    = linspecer(20,'sequential');
            L     = Fig_2_1D.Set_Labels_2();
            [m,n] = size(msh.s.xf);
            for i = 1:m
                for j = 1:n
                    p(j,i) = length(msh.s.xf{i,j});
                end
            end
            %  > 2.1.1. ---------------------------------------------------
            subplot(2,1,1);
            Fig_2_1D.SubPlot_2(msh,pde,Xvi,Xvf,C1,L);
            %  > 2.1.2. ---------------------------------------------------
            subplot(2,1,2);
            Fig_2_1D.SubPlot_3(msh,C2,p,m,n);           
        end
        %  > 2.1.1. -------------------------------------------------------
        function [] = SubPlot_2(msh,pde,Xvi,Xvf,C1,L)
            hold on;
            P{1} = plot(msh.c.Xc,pde.e.c.c(:,1)             ,'-s','Color',C1(1,:),'LineWidth',2.0,'MarkerFaceColor','w','MarkerSize',3.5);
            P{2} = line([Xvi,Xvf],[pde.e.c.n(1,1),pde.e.c.n(1,1)],'Color',C1(1,:),'Linewidth',1.5,'Linestyle',':' );
            %  > Legend.
            legend([P{:}],[L{:}],...
                'Interpreter','latex','Location','Northeast','FontSize',15,'NumColumns',2);
            %  > Axis.
            Fig_Tools_1D.ChangeLook_1D(true,true,true,msh.f.Xv,10,"$x$",L{3},15,15);
        end
        % >> 2.2. ---------------------------------------------------------
        function [L] = Set_Labels_2()
            L{1} = "$|e_{c}^{\phantom{\nabla}\phi}|$";
            L{2} = "$|\!|e_{c}^{\phantom{\nabla}\phi}|\!|_{1}$";
            L{3} = "$\textrm{Error magnitude}, |e^{\phi}|$";
        end
    end
end      