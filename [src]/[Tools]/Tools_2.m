classdef Tools_2
    methods (Static)
        %% > 1. -----------------------------------------------------------
        % >> Compute polynomial regression coefficients/exponents.
        %  > -------------|------------------------------------------------------------------------------------------------|
        %  > Term       = | 1 | x | y | x^2 | xy  | y^2 | x^3  | x^2y | xy^2 | y^3  | x^4  | x^3y  | x^2y^2 | xy^3  | y^4  | (...)
        %  > -------------|------------------------------------------------------------------------------------------------|
        %  > C          = | 1 | 1 | 1 | 1   | 1   | 1   | 1    | 1    | 1    | 1    | 1    | 1     | 1      | 1     | 1    | (...)
        %  > exp_x      = | 0 | 1 | 0 | 2   | 1   | 0   | 3    | 2    | 1    | 0    | 4    | 3     | 2      | 1     | 0    | (...)
        %  > exp_y      = | 0 | 0 | 1 | 0   | 1   | 2   | 0    | 1    | 2    | 3    | 0    | 1     | 2      | 3     | 4    | (...)
        %  > -------------|------------------------------------------------------------------------------------------------|
        %  > Term  (dx) = | 0 | 1 | 0 | 2x  | y   | 0   | 3x^2 | 2xy  | y^2  | 0    | 4x^3 | 3x^2y | 2xy^2  | y^3   | 0    | (...)
        %  > -------------|------------------------------------------------------------------------------------------------|
        %  > C          = | 0 | 1 | 0 | 2   | 1   | 0   | 3    | 2    | 1    | 0    | 4    | 3     | 2      | 1     | 0    | (...)
        %  > dx (exp_x) = | 0 | 0 | 0 | 1   | 0   | 0   | 2    | 1    | 0    | 0    | 3    | 2     | 1      | 0     | 0    | (...)
        %  > dx (exp_y) = | 0 | 0 | 0 | 0   | 1   | 0   | 0    | 1    | 2    | 0    | 0    | 1     | 2      | 3     | 0    | (...)
        %  > -------------|------------------------------------------------------------------------------------------------|
        %  > Term  (dy) = | 0 | 0 | 1 | 0   | x   | 2y  | 0    | x^2  | 2xy  | 3y^2 | 0    | x^3   | 2x^2y  | 3xy^2 | 4y^3 | (...)
        %  > -------------|------------------------------------------------------------------------------------------------|
        %  > C          = | 0 | 0 | 1 | 0   | 1   | 2   | 0    | 1    | 2    | 3    | 0    | 1     | 2      | 3     | 4    | (...)
        %  > dy (exp_x) = | 0 | 0 | 0 | 0   | 1   | 0   | 0    | 2    | 1    | 0    | 0    | 3     | 2      | 1     | 0    | (...)
        %  > dy (exp_y) = | 0 | 0 | 0 | 0   | 0   | 1   | 0    | 0    | 1    | 2    | 0    | 0     | 1      | 2     | 3    | (...)
        %  > -------------|------------------------------------------------------------------------------------------------|
        %  > #of terms  = | 1 | 2 | 3 | 4   | 5   | 6   | 7    | 8    | 9    | 10   | 11   | 12    | 13     | 14    | 15   | (...)
        %  > -------------|------------------------------------------------------------------------------------------------| (...)
        %                 | p = 1     | p = 3                                       | p = 5                                   ...
        %  > -------------|------------------------------------------------------------------------------------------------|
        %  > --------------------------------------------------------------
        %  > \phi_f (exponents).
        %  > --------------------------------------------------------------
        %  > x:        > y:
        %  | 0         | 0
        %  | 1 0       | 0 1
        %  | 2 1 0     | 0 1 2
        %  | 3 2 1 0   | 0 1 2 3
        %  | 4 3 2 1 0 | 0 1 2 3 4
        %  | ...       | ...
        %  > --------------------------------------------------------------
        %  > \nabla\phi_f (exponents).
        %  > --------------------------------------------------------------
        %  > d(x)/dx:  > d(x)/dy:  | d(y)/dx:  | d(y)/dy:
        %  | 0         | 0         | 0         | 0
        %  | 0 0       | 0 0       | 0 0       | 0 0
        %  | 1 0 0     | 0 1 0     | 0 1 0     | 0 0 1
        %  | 2 1 0 0   | 0 1 2 0   | 0 2 1 0   | 0 0 1 2
        %  | 3 2 1 0 0 | 0 1 2 3 0 | 0 3 2 1 0 | 0 0 1 2 3
        %  | ...       | ...       | ...       | ...
        %  > --------------------------------------------------------------
        % >> 1.1. ---------------------------------------------------------
        %  > \phi_f.
        %  > Number of coefficients: (x.^2+x)./2.
        function [t] = Terms_1(p)
            %  > Initialize...
            n   = (p+1).*(p+2)./2;
            t.c = ones (1,n);
            t.e = zeros(2,n);
            
            for i = 0:p
                j        = (i.^2+i)./2+1:((i+1).^2+(i+1))./2;
                t.e(1,j) = i:-1:0; % > x.
                t.e(2,j) = 0:i;    % > y.
            end
        end
        % >> 1.2. ---------------------------------------------------------
        %  > \nabla\phi_f_x OR \nabla\phi_f_y.
        %  > Number of coefficients: (x.^2+x)./2.
        function [t] = Terms_2(p,i)
            %  > Initialize...
            n   = (p+1).*(p+2)./2;
            t.c = zeros(1,n);
            t.e = zeros(2,n);
            
            %  > Select...
            switch i
                case 1
                    % >> \nabla\phi_f_x.
                    for j = 0:p
                        k = (j.^2+j)./2+1:((j+1).^2+(j+1))./2;
                        %  > (c).
                        t.c(1,k) = j:-1:0;
                        %  > (e).
                        if j ~= 0
                            t.e(:,k) = [[j-1:-1:0,0];[0:j-1,0]];
                        end
                    end
                case 2
                    % >> \nabla\phi_f_y.
                    for j = 0:p
                        k = (j.^2+j)./2+1:((j+1).^2+(j+1))./2;
                        %  > (c).
                        t.c(1,k) = 0:j;
                        %  > (e).
                        if j ~= 0
                            t.e(:,k) = [[0,j-1:-1:0];[0,0:j-1]];
                        end
                    end
                otherwise
                    return;
            end
        end
        % >> 1.3. ---------------------------------------------------------
        %  > \nabla\phi_f_x AND \nabla\phi_f_y.
        %  > Number of coefficients: (x.^2+x)./2.
        function [t] = Terms_3(p)
            %  > Initialize...
            n   = (p+1).*(p+2)./2;
            t.c = zeros(2,n);
            t.e = cell (1,2);
            for i = 1:numel(t.e)
                t.e{i} = zeros(2,n);
            end
            
            for j = 0:p
                k = (j.^2+j)./2+1:((j+1).^2+(j+1))./2;
                %  > (c).
                t.c(1,k) = j:-1:0;
                t.c(2,k) = 0:j;
                %  > (e).
                if j ~= 0
                    t.e{1}(:,k) = [[j-1:-1:0,0];[0:j-1,0]];
                    t.e{2}(:,k) = [[0,j-1:-1:0];[0,0:j-1]];
                end
            end
        end

        %% > 2. -----------------------------------------------------------
        %  > 2.1. ---------------------------------------------------------
        %  > Compute error norms (cell/face L1,L2 and L_infinity norms).
        function [L] = Set_n(E,V)
            if nargin == 1
                L(1,:) = Tools_1.mean(E,1);
                L(2,:) = Tools_1.mean(sqrt(E.^2),1);
                L(3,:) = max         (E);
            else
                L(1,:) = sum(E.*V)./sum(V);
                L(2,:) = sum(sqrt((E.*V).^2))./sum(sqrt(V.^2));
                L(3,:) = max(E);
            end
        end
    end
end